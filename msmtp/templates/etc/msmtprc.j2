###
### {{ ansible_managed }}
###

defaults

{% for account in accounts %}
account {{ account.name }}
host {{ account.smtp_host }}
{% if account.smtp_port is defined %}
port {{ account.smtp_port }}
{% endif %}
{% if account.tls is defined %}
tls {{ account.tls | ternary('on','off') }}
{% endif %}
{% if account.starttls is defined %}
tls_starttls {{ account.starttls | ternary('on','off') }}
{% endif %}
{% if account.auth is defined %}
auth {{ account.auth | ternary('on','off') }}
user {{ account.user }}
password {{ passwords[account.name] }}
{% endif %}
{% endfor %}

# Construct envelope-from addresses of the form "user@oursite.example"
auto_from {{ auto_from | ternary('on','off') }}
maildomain {{ maildomain }}

# Syslog logging with facility {{ syslog }} instead of the default LOG_USER
syslog {{ syslog }}
