---
# defaults file for roles/gitlab

#
# Substitutions
#

gitlab__enable: "{{ gitlab_enable | default (false) }}"
gitlab__docker: "{{ gitlab_docker | default (true) }}"
gitlab__flavor: "{{ gitlab_flavor | default('ce') }}"

gitlab__home: "{{ gitlab_home | default('/srv/gitlab') }}"
gitlab__data: "{{ gitlab_data | default('$GITLAB_HOME/data') }}"
gitlab__logs: "{{ gitlab_logs | default('$GITLAB_HOME/logs') }}"
gitlab__config: "{{ gitlab_config | default('$GITLAB_HOME/config') }}"

gitlab__listen_address: "{{ gitlab_listen_address | default ('127.0.0.1') }}"
gitlab__extra_hosts: "{{ gitlab_extra_hosts | default ([]) }}"
gitlab__environment: "{{ gitlab_environment | default ('') }}"

gitlab__external_url: "{{ gitlab_external_url | default ('') }}"
gitlab__ssh_host: "{{ gitlab_ssh_host | default ('') }}"
gitlab__timezone: "{{ gitlab_timezone | default('') }}"

gitlab__ldap_enabled: "{{ gitlab_ldap_enabled | default(false) }}"
gitlab__ldap_label: "{{ gitlab_ldap_label | default('LDAP') }}"
gitlab__ldap_host: "{{ gitlab_ldap_host | default('') }}"
gitlab__ldap_port: "{{ gitlab_ldap_port | default(389) }}"
gitlab__ldap_uid: "{{ gitlab_ldap_uid | default('sAMAccountName') }}"
gitlab__ldap_encryption: "{{ gitlab_ldap_encryption | default('plain') }}"
gitlab__ldap_active_directory: "{{ gitlab_ldap_active_directory | default(true) }}"
gitlab__ldap_allow_username_or_email_login: "{{ gitlab_ldap_allow_username_or_email_login | default(false) }}"
gitlab__ldap_lowercase_usernames: "{{ gitlab_ldap_lowercase_usernames | default(false) }}"
gitlab__ldap_block_auto_created_users: "{{ gitlab_ldap_block_auto_created_users | default(false) }}"
gitlab__ldap_base: "{{ gitlab_ldap_base | default('') }}"
gitlab__ldap_user_filter: "{{ gitlab_ldap_user_filter | default('') }}"

gitlab__nginx_enabled: "{{ gitlab_nginx_enabled | default (true) }}"
gitlab__nginx_client_max_body_size: "{{ gitlab_nginx_client_max_body_size | default ('250m') }}"
gitlab__nginx_redirect_http_to_https: "{{ gitlab_nginx_redirect_http_to_https | default (false) }}"
gitlab__nginx_redirect_http_to_https_port: "{{ gitlab_nginx_redirect_http_to_https_port | default (80) }}"
gitlab__nginx_ssl_verify_client: "{{ gitlab_nginx_ssl_verify_client | default (false) }}"
gitlab__nginx_ssl_verify_depth: "{{ gitlab_nginx_ssl_verify_depth | default (1) }}"
gitlab__nginx_ssl_ciphers_default:
  - ECDHE-ECDSA-AES128-GCM-SHA256
  - ECDHE-RSA-AES128-GCM-SHA256
  - ECDHE-ECDSA-AES256-GCM-SHA384
  - ECDHE-RSA-AES256-GCM-SHA384
  - ECDHE-ECDSA-CHACHA20-POLY1305
  - ECDHE-RSA-CHACHA20-POLY1305
  - DHE-RSA-AES128-GCM-SHA256
  - DHE-RSA-AES256-GCM-SHA384
gitlab__nginx_ssl_ciphers: "{{ gitlab_nginx_ssl_ciphers | default (gitlab__nginx_ssl_ciphers_default) }}"
gitlab__nginx_ssl_prefer_server_ciphers: "{{ gitlab_nginx_ssl_prefer_server_ciphers | default (false) }}"
gitlab__nginx_ssl_protocols_default:
  - TLSv1.2
  - TLSv1.3
gitlab__nginx_ssl_protocols: "{{ gitlab_nginx_ssl_protocols | default (gitlab__nginx_ssl_protocols_default) }}"
gitlab__nginx_ssl_session_cache: "{{ gitlab_nginx_ssl_session_cache | default ('shared:SSL:10m') }}"
gitlab__nginx_ssl_session_tickets: "{{ gitlab_nginx_ssl_session_tickets | default (false) }}"
gitlab__nginx_ssl_session_timeout: "{{ gitlab_nginx_ssl_session_timeout | default ('1d') }}"
gitlab__nginx_listen_addresses_default:
  - '*'
  - '[::]'
gitlab__nginx_listen_addresses: "{{ gitlab_nginx_listen_addresses | default (gitlab__nginx_listen_addresses_default) }}"
gitlab__nginx_hsts_max_age: "{{ gitlab__ginx_hsts_max_age | default (63072000) }}"
gitlab__nginx_hsts_include_subdomains: "{{ gitlab_nginx_hsts_include_subdomains | default (false) }}"
gitlab__nginx_referrer_policy: "{{ gitlab_nginx_referrer_policy | default ('strict-origin-when-cross-origin') }}"
gitlab__nginx_gzip_enabled: "{{ gitlab_nginx_gzip_enabled | default (true) }}"

gitlab__logrotate_enable: "{{ gitlab_logrotate_enable | default (true) }}"
gitlab__logrotate_log_directory: "{{ gitlab_logrotate_log_directory | default ('/var/log/gitlab/logrotate') }}"

gitlab__letsencrypt_enable: "{{ gitlab_letsencrypt_enable | default (false) }}"
gitlab__letsencrypt_contact_emails: "{{ gitlab_letsencrypt_contact_emails | default ([]) }}"
gitlab__letsencrypt_group: "{{ gitlab_letsencrypt_group | default ('root') }}"
gitlab__letsencrypt_key_size: "{{ gitlab_letsencrypt_key_size | default (2048) }}"
gitlab__letsencrypt_owner: "{{ gitlab_letsencrypt_owner | default ('root') }}"
gitlab__letsencrypt_auto_renew: "{{ gitlab_letsencrypt_auto_renew | default (true) }}"
gitlab__letsencrypt_auto_renew_hour: "{{ gitlab_letsencrypt_auto_renew_hour | default (0) }}"
gitlab__letsencrypt_auto_renew_minute: "{{ gitlab_letsencrypt_auto_renew_minute | default ('nil') }}"
gitlab__letsencrypt_auto_renew_day_of_month: "{{ gitlab_letsencrypt_auto_renew_day_of_month | default ('*/4') }}"
gitlab__letsencrypt_auto_renew_log_directory: "{{ gitlab_letsencrypt_auto_renew_log_directory | default ('/var/log/gitlab/lets-encrypt') }}"

#
# Do not change from here
#

gitlab__packages_default: "{{ gitlab__packages_flavors[gitlab__flavor] }}"

gitlab__packages_flavors:
  ce:
  - gitlab-ce
  ee:
  - gitlab-ee

gitlab__packages: "{{ gitlab__packages_default }}"
