---
# defaults file for roles/icinga

icinga_packages: []
icinga_features: []
icinga_conf_notification: {}
icinga_conf_templates: {}
icingaweb_packages: []
icingaweb_modules: []

#
# Substitutions
#

icinga__enable: "{{ icinga_enable | default (false) }}"
icinga__pki_enable: "{{ icinga_pki_enable | default (false) }}"
icinga__mysql_enable: "{{ icinga_mysql_enable | default (false) }}"
icinga__pgsql_enable: "{{ icinga_pgsql_enable | default (false) }}"

icinga__role_master:  "{{ icinga_role_master | default (false) }}"
icinga__role_agent:  "{{ icinga_role_agent | default (false) }}"

icinga__plugins_contrib:  "{{ icinga_plugins_contrib | default (false) }}"
icinga__plugins_manubulon:  "{{ icinga_plugins_manubulon | default (false) }}"

icinga__constant_plugin_dir: "{{ icinga_constant_plugin_dir | default ('/usr/lib/nagios/plugins') }}"
icinga__constant_manubulon_plugin_dir: "{{ icinga_constant_manubulon_plugin_dir | default ('/usr/lib/nagios/plugins') }}"
icinga__constant_plugin_contrib_dir: "{{ icinga_constant_plugin_contrib_dir | default ('/usr/lib/nagios/plugins') }}"
icinga__constant_plugin_local_dir: "{{ icinga_constant_plugin_local_dir | default ('/usr/local/lib/nagios/plugins') }}"
icinga__constant_node_name: "{{ icinga_constant_node_name | default ('localhost') }}"
icinga__constant_zone_name: "{{ icinga_constant_zone_name | default (icinga__constant_node_name) }}"
icinga__constant_ticket_salt: "{{ icinga_constant_ticket_salt | default ('') }}"

icinga__api_bind_host: "{{ icinga_api_bind_host | default ('0.0.0.0') }}"
icinga__api_bind_port: "{{ icinga_api_bind_port | default (5665) }}"

icinga__pki_realm: "{{ icinga_pki_realm | default (icinga__constant_node_name) }}"

icinga__mysql_host: "{{ icinga_mysql_host | default ('localhost') }}"
icinga__mysql_user: "{{ icinga_mysql_user | default ('icinga') }}"
icinga__mysql_database:  "{{ icinga_mysql_database | default ('icinga') }}"
icinga__mysql_password: "{{ icinga__password['mysql'] | default ('') }}"

icinga__conf_api_users: "{{ icinga_conf_api_users | default({}) }}"
icinga__conf_commands: "{{ icinga_conf_commands | default(icinga__conf_commands_default) }}"
icinga__conf_downtimes: "{{ icinga_conf_downtimes | default(icinga__conf_downtimes_default) }}"
icinga__conf_groups: "{{ icinga_conf_groups | default(icinga__conf_groups_default) }}"
icinga__conf_hosts: "{{ icinga_conf_hosts | default(icinga__conf_hosts_default) }}"
icinga__conf_notifications: "{{ icinga__conf_notifications_default | combine(icinga_conf_notifications) }}"
icinga__conf_services: "{{ icinga_conf_services | default(icinga__conf_services_default) }}"
icinga__conf_templates: "{{ icinga__conf_templates_default | combine(icinga_conf_templates) }}"
icinga__conf_timeperiods: "{{ icinga_conf_timeperiods | default(icinga__conf_timeperiods_default) }}"
icinga__conf_users: "{{ icinga_conf_users | default(icinga__conf_users_default) }}"
icinga__zones: "{{ icinga_zones | default(icinga__zones_default) }}"

icinga__password: "{{ vault__icinga_password | default({}) }}"

icingaweb__enable: "{{ icingaweb_enable | default (false) }}"
icingaweb__password: "{{ vault__icingaweb_password | default({}) }}"

icingaweb__authentication_section: "{{ icingaweb_authentication_section | default('icingaweb2') }}"
icingaweb__authentication_backend: "{{ icingaweb_authentication_backend | default('') }}"
icingaweb__authentication_user_backend: "{{ icingaweb_authentication_user_backend | default(icingaweb__authentication_section) }}"
icingaweb__authentication_resource: "{{ icingaweb_authentication_resource | default('') }}"
icingaweb__authentication_base_dn: "{{ icingaweb_authentication_base_dn | default('') }}"
icingaweb__authentication_group_base_dn: "{{ icingaweb_authentication_group_base_dn | default(icingaweb__authentication_base_dn) }}"
icingaweb__authentication_user_class: "{{ icingaweb_authentication_user_class | default('inetOrgPerson') }}"
icingaweb__authentication_user_name_attribute: "{{ icingaweb_authentication_user_name_attribute | default('uid') }}"
icingaweb__authentication_group_class: "{{ icingaweb_authentication_group_class | default('group') }}"
icingaweb__authentication_group_name_attribute: "{{ icingaweb_authentication_group_name_attribute | default('gid') }}"
icingaweb__authentication_group_member_attribute: "{{ icingaweb_authentication_group_member_attribute | default('member') }}"
icingaweb__authentication_filter: "{{ icingaweb_authentication_filter | default('') }}"
icingaweb__authentication_group_filter: "{{ icingaweb_authentication_group_filter | default('') }}"

icingaweb__config_global: "{{ icingaweb_config_global | default(icingaweb__config_global_default) }}"
icingaweb__config_logging: "{{ icingaweb_config_logging | default(icingaweb__config_logging_default) }}"
icingaweb__modules_config: "{{ icingaweb_modules_config | default(icingaweb__modules_config_default) }}"

icingaweb__resources: "{{ icingaweb_resources | default({}) }}"
icingaweb__roles: "{{ icingaweb_roles | default({}) }}"

#
# Do not change from here
#

icinga__packages_default:
- dnsutils
- snmp
- monitoring-plugins
- icinga2

icingaweb__packages_default:
- icingacli
- icingaweb2
- icingaweb2-module-monitoring
- nagios-images

icinga__features_default:
- checker
- mainlog
- notification

icingaweb__config_global_default:
  show_stacktraces: 1
  config_backend: ini

icingaweb__config_logging_default:
  log: file
  level: ERROR
  file: /var/log/icingaweb2/icingaweb2.log

icingaweb__modules_config_default:
  monitoring:
    backends:
      icinga:
        type: ido
        resource: icinga_ido
    commandtransports:
      icinga2:
        transport: api
        host: localhost
        port: 5665
        username: icingaweb
        password: "{{ icingaweb__password['icingaapi'] }}"
    config:
      security:
        protected_customvars: '*pw*,*pass*,community'
      
icingaweb__modules_default:
- monitoring

icinga__files_absent:
- conf.d/apt.conf

icinga__api_features: "{{ [ 'api'] if icinga__role_master or icinga__role_agent else [] }}"

icinga__mysql_packages: "{{ [ 'icinga2-ido-mysql' ] if icinga__mysql_enable else [] }}"
icinga__mysql_features: "{{ [ 'ido-mysql'] if icinga__mysql_enable else [] }}"

icinga__pgsql_packages: "{{ [ 'icinga2-ido-pgsql' ] if icinga__pgsql_enable else [] }}"
icinga__pgsql_features: "{{ [ 'ido-pgsql'] if icinga__pgsql_enable else [] }}"

icinga__packages_combined: "{{ icinga__packages_default + icinga_packages + icinga__mysql_packages + icinga__pgsql_packages }}"
icinga__features_combined: "{{ icinga__features_default + icinga_features + icinga__api_features + icinga__mysql_features + icinga__pgsql_features }}"
icingaweb__packages_combined: "{{ icingaweb__packages_default + icingaweb_packages }}"
icingaweb__modules_combined: "{{ icingaweb__modules_default + icingaweb_modules }}"
