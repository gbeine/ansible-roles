---
# defaults file for postfix

postfix_packages: []
postfix_postgrey_opts: {}

#
# Substitutions
#

postfix__enable: "{{ postfix_enable | default(false) }}"
postfix__etc_path: "{{ postfix_etc_path | default('/etc/postfix') }}"

postfix__postgrey_enable: "{{ postfix_postgrey_enable | default(false) }}"
postfix__postsrsd_enable: "{{ postfix_postsrsd_enable | default(false) }}"
postfix__policyd_spf_enable: "{{ postfix_policyd_spf_enable | default(false) }}"
postfix__spamassassin_enable: "{{ postfix_spamassassin_enable | default(false) }}"
postfix__dkim_enable: "{{ postfix_dkim_enable | default(false) }}"
postfix__dmarc_enable: "{{ postfix_dmarc_enable | default(false) }}"

postfix__postsrsd_domain: "{{ postfix_postsrsd_domain | default('') }}"
postfix__postsrsd_exclude_domains: "{{ postfix_postsrsd_exclude_domains | default([]) }}"
postfix__postsrsd_separator: "{{ postfix_postsrsd_separator | default('=') }}"
postfix__postsrsd_secret_file: "{{ postfix_postsrsd_secret | default('/etc/postsrsd.secret') }}"
postfix__postsrsd_hashlength: "{{ postfix_postsrsd_hashlength | default(4) }}"
postfix__postsrsd_hashmin: "{{ postfix_postsrsd_hashmin | default(4) }}"
postfix__postsrsd_forward_port: "{{ postfix_postsrsd_forward_port | default(10001) }}"
postfix__postsrsd_reverse_port: "{{ postfix_postsrsd_reverse_port | default(10002) }}"
postfix__postsrsd_run_as: "{{ postfix_postsrsd_run_as | default('postsrsd') }}"
postfix__postsrsd_listen_addr: "{{ postfix_postsrsd_listen_addr | default('127.0.0.1') }}"
postfix__postsrsd_chroot: "{{ postfix_postsrsd_chroot | default('/var/lib/postsrsd') }}"
postfix__postsrsd_secret: "{{ vault__postsrsd_secret | default('') }}"

postfix__spampd_startspamd: "{{ postfix_spampd_startspamd | default(false) }}"
postfix__spampd_pidfile: "{{ postfix_spampd_pidfile | default('/var/run/spampd.pid') }}"
postfix__spampd_listenhost: "{{ postfix_spampd_listenhost | default('127.0.0.1') }}"
postfix__spampd_listenport: "{{ postfix_spampd_listenport | default(10025) }}"
postfix__spampd_desthost: "{{ postfix_spampd_desthost | default('127.0.0.1') }}"
postfix__spampd_destport: "{{ postfix_spampd_destport | default(10026) }}"
postfix__spampd_children: "{{ postfix_spampd_children | default(3) }}"
postfix__spampd_userid: "{{ postfix_spampd_userid | default('spampd') }}"
postfix__spampd_grpid: "{{ postfix_spampd_grpid | default('spampd') }}"
postfix__spampd_tagall: "{{ postfix_spampd_tagall | default(true) }}"
postfix__spampd_autowhitelist: "{{ postfix_spampd_autowhitelist | default(false) }}"
postfix__spampd_localonly: "{{ postfix_spampd_localonly | default(true) }}"
postfix__spampd_loginet: "{{ postfix_spampd_loginet | default(false) }}"
postfix__spampd_addopts: "{{ postfix_spampd_addopts | default('') }}"

postfix__spampd_options: "{{ postfix_spampd_options | default([]) }}"

postfix__dkim_opendkim_keydir: "{{ postfix_dkim_opendkim_keydir | default('/etc/dkimkeys') }}"
postfix__dkim_opendkim_etc_path: "{{ postfix_dkim_opendkim_etc_path | default('/etc/opendkim') }}"
postfix__dkim_opendkim_log_path: "{{ postfix_dkim_opendkim_log_path | default('/var/log/opendkim') }}"

postfix__dkim_opendkim_daemon_opts: "{{ postfix_dkim_opendkim_daemon_opts | default('') }}"
postfix__dkim_opendkim_rundir: "{{ postfix_dkim_opendkim_rundir | default('/run/opendkim') }}"
postfix__dkim_opendkim_socket: "{{ postfix_dkim_opendkim_socket | default('local:' + postfix__dkim_opendkim_rundir + '/opendkim.sock') }}"
postfix__dkim_opendkim_user: "{{ postfix_dkim_opendkim_user | default('opendkim') }}"
postfix__dkim_opendkim_group: "{{ postfix_dkim_opendkim_group | default('opendkim') }}"
postfix__dkim_opendkim_pidfile: "{{ postfix_dkim_opendkim_pidfile | default(postfix__dkim_opendkim_rundir + '/opendkim.pid') }}"
postfix__dkim_opendkim_extraafter: "{{ postfix_dkim_opendkim_daemon_opts | default('') }}"

postfix__dkim_opendkim_syslog: "{{ postfix_dkim_opendkim_syslog | default(true) }}"
postfix__dkim_opendkim_umask: "{{ postfix_dkim_opendkim_umask | default('007') }}"
postfix__dkim_opendkim_domain: "{{ postfix_dkim_opendkim_domain | default('') }}"
postfix__dkim_opendkim_keyfile: "{{ postfix__dkim_opendkim_keydir + '/mail.private' }}"
postfix__dkim_opendkim_selector: "{{ postfix_dkim_opendkim_selector | default('') }}"
postfix__dkim_opendkim_canonicalization: "{{ postfix_dkim_opendkim_canonicalization | default('') }}"
postfix__dkim_opendkim_mode: "{{ postfix_dkim_opendkim_mode | default('') }}"
postfix__dkim_opendkim_subdomains: "{{ postfix_dkim_opendkim_subdomains | default(false) }}"
postfix__dkim_opendkim_statistics: "{{ postfix_dkim_opendkim_statistics | default(postfix__dkim_opendkim_log_path + '/dkim-stats') }}"

postfix__dkim_opendkim_oversignheaders: "{{ postfix_dkim_opendkim_oversignheaders | default('From') }}"
postfix__dkim_opendkim_resolver: "{{ postfix_dkim_opendkim_resolver | default(false) }}"
postfix__dkim_opendkim_resolverconfiguration: "{{ postfix_dkim_opendkim_resolverconfiguration | default('/etc/unbound/unbound.conf') }}"
postfix__dkim_opendkim_trustanchorfile: "{{ postfix_dkim_opendkim_trustanchorfile | default('/usr/share/dns/root.key') }}"
postfix__dkim_opendkim_userid: "{{ postfix_dkim_opendkim_userid | default(postfix__dkim_opendkim_user) }}"

postfix__dkim_opendkim_internal_hosts: "{{ postfix_dkim_opendkim_internal_hosts | default(postfix__dkim_opendkim_etc_path + '/InternalHosts.txt') }}"
postfix__dkim_opendkim_internal_hosts_content: "{{ postfix_dkim_opendkim_internal_hosts_content | default([]) }}"

postfix__dkim_opendkim_key_genkey: "{{ postfix_dkim_opendkim_key_genkey | default('/usr/bin/opendkim-genkey') }}"
postfix__dkim_opendkim_key_bits: "{{ postfix_dkim_opendkim_key_bits | default('2048') }}"
postfix__dkim_opendkim_key_selector: "{{ postfix__dkim_opendkim_selector }}"
postfix__dkim_opendkim_key_domain: "{{ postfix_dkim_opendkim_domain }}"

postfix__dmarc_opendmarc_etc_path: "{{ postfix_dmarc_opendmarc_etc_path | default('/etc/opendmarc') }}"

postfix__dmarc_opendmarc_daemon_opts: "{{ postfix_dmarc_opendmarc_daemon_opts | default('') }}"
postfix__dmarc_opendmarc_rundir: "{{ postfix_dmarc_opendmarc_rundir | default('/var/run/opendmarc') }}"
postfix__dmarc_opendmarc_socket: "{{ postfix_dmarc_opendmarc_socket | default('local:/var/run/opendmarc/opendmarc.sock') }}"
postfix__dmarc_opendmarc_user: "{{ postfix_dmarc_opendmarc_user | default('opendmarc') }}"
postfix__dmarc_opendmarc_group: "{{ postfix_dmarc_opendmarc_group | default('opendmarc') }}"
postfix__dmarc_opendmarc_pidfile: "{{ postfix_dmarc_opendmarc_pidfile | default('/var/run/opendmarc/opendmarc.pid') }}"
postfix__dmarc_opendmarc_extraafter: "{{ postfix_dmarc_opendmarc_extraafter | default('') }}"

postfix__dmarc_opendmarc_authservid: "{{ postfix_dmarc_opendmarc_authservid | default('') }}"
postfix__dmarc_opendmarc_failurereports: "{{ postfix_dmarc_opendmarc_failurereports | default(false) }}"
postfix__dmarc_opendmarc_publicsuffixlist: "{{ postfix_dmarc_opendmarc_publicsuffixlist | default('/usr/share/publicsuffix') }}"
postfix__dmarc_opendmarc_rejectfailures: "{{ postfix_dmarc_opendmarc_rejectfailures | default(false) }}"
postfix__dmarc_opendmarc_syslog: "{{ postfix_dmarc_opendmarc_syslog | default(true) }}"
postfix__dmarc_opendmarc_syslogfacility: "{{ postfix_dmarc_opendmarc_syslogfacility | default('mail') }}"
postfix__dmarc_opendmarc_trustedauthservids: "{{ postfix_dmarc_opendmarc_trustedauthservids | default('HOSTNAME') }}"
postfix__dmarc_opendmarc_umask: "{{ postfix_dmarc_opendmarc_umask | default('0002') }}"

postfix__virtual_tables_ldap: "{{ postfix_virtual_tables_ldap | default({}) }}"

#
# Do not change from here
#

postfix__packages_default:
- postfix

postfix__postgrey_packages:
- postgrey

postfix__postgrey_options_default:
  inet: 10023

postfix__postsrsd_packages:
- postsrsd

postfix__policyd_spf_packages:
- postfix-policyd-spf-perl

postfix__dkim_packages:
- opendkim
- opendkim-tools

postfix__dmarc_packages:
- opendmarc

postfix__spamassassin_packages:
- spamassassin
- spamc
- spampd

postfix__main_combined: "{{ postfix__main_default | combine(postfix_main) }}"
postfix__master_combined: "{{ postfix__master_default | merge_by_splittedkey(postfix_master, 'service', 'type') }}"
postfix__packages_combined: "{{ postfix__packages_default + postfix_packages }}"

postfix__postgrey_options_combined: "{{ postfix__postgrey_options_default | combine(postfix_postgrey_options) | join_with_prefix('--') }}"
