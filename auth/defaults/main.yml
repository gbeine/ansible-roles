---
# defaults file for roles/auth

#
# Substitutions
#

auth__enable: "{{ auth_enable | default(false) }}"

auth__authorized_keys_enable: "{{ auth_authorized_keys_enable | default(true) and auth__authorized_keys | length > 0 }}"
auth__authorized_keys: "{{ auth_authorized_keys | default([]) }}"

auth__sudoers_enable: "{{ auth_sudoers_enable | default(true) and ( auth__sudoers | length > 0 ) or ( auth__sudoers_files | length > 0) }}"
auth__sudoers: "{{ auth_sudoers | default({}) }}"
auth__sudoers_files: "{{ auth_sudoers_files | default({}) }}"

auth__nscd_enable: "{{ auth_nscd_enable | default(false) }}"

auth__nslcd_enable: "{{ auth_nslcd_enable | default(false) }}"
auth__nslcd_uid: "{{ auth_nslcd_uid | default('nslcd') }}"
auth__nslcd_gid: "{{ auth_nslcd_gid | default('nslcd') }}"
auth__nslcd_uri: "{{ auth_nslcd_uri | default('ldap://localhost/') }}"
auth__nslcd_idle_timelimit: "{{ auth_nslcd_idle_timelimit | default(600) }}"
auth__nslcd_base: "{{ auth_nslcd_base | default('dc=example,dc=org') }}"
auth__nslcd_ldap_version: "{{ auth_nslcd_ldap_version | default(3) }}"
auth__nslcd_binddn: "{{ auth_nslcd_binddn | default('none') }}"
auth__nslcd_bindpw: "{{ auth_nslcd_bindpw | default('none') }}"
auth__nslcd_rootpwmoddn: "{{ auth_nslcd_rootpwmoddn | default('none') }}"
auth__nslcd_ssl: "{{ auth_nslcd_ssl | default(false) }}"
auth__nslcd_tls_reqcert: "{{ auth_nslcd_tls_reqcert | default('allow') }}"
auth__nslcd_tls_cacertfile: "{{ auth_nslcd_tls_cacertfile | default('/etc/ssl/certs/ca-certificates.crt') }}"
auth__nslcd_scope: "{{ auth_nslcd_scope | default('subtree') }}"
auth__nslcd_nss_min_uid: "{{ auth_nslcd_nss_min_uid | default(1000) }}"
auth__nslcd_filter: "{{ auth_nslcd_filter | default('passwd (objectClass=posixAccount)') }}"
auth__nslcd_deref: "{{ auth_nslcd_deref | default('never') }}"
auth__nslcd_referrals: "{{ auth_nslcd_referrals | default(false) }}"


auth__nsswitch_enable: "{{ auth_nsswitch_enable | default(false) }}"
auth__nsswitch_passwd: "{{ auth_nsswitch_passwd | default(auth__nsswitch_passwd_default) }}"
auth__nsswitch_group: "{{ auth_nsswitch_group | default(auth__nsswitch_group_default) }}"
auth__nsswitch_shadow: "{{ auth_nsswitch_shadow | default(auth__nsswitch_shadow_default) }}"
auth__nsswitch_gshadow: "{{ auth_nsswitch_gshadow | default(auth__nsswitch_gshadow_default) }}"
auth__nsswitch_hosts: "{{ auth_nsswitch_hosts | default(auth__nsswitch_hosts_default) }}"
auth__nsswitch_networks: "{{ auth_nsswitch_networks | default(auth__nsswitch_networks_default) }}"
auth__nsswitch_protocols: "{{ auth_nsswitch_protocols | default(auth__nsswitch_protocols_default) }}"
auth__nsswitch_services: "{{ auth_nsswitch_services | default(auth__nsswitch_services_default) }}"
auth__nsswitch_ethers: "{{ auth_nsswitch_ethers | default(auth__nsswitch_ethers_default) }}"
auth__nsswitch_rpc: "{{ auth_nsswitch_rpc | default(auth__nsswitch_rpc_default) }}"
auth__nsswitch_netgroup: "{{ auth_nsswitch_netgroup | default(auth__nsswitch_netgroup_default) }}"

#
# Do not change from here
#

auth__nsswitch_passwd_default: [ 'files' ]
auth__nsswitch_group_default: [ 'files' ]
auth__nsswitch_shadow_default: [ 'files' ]
auth__nsswitch_gshadow_default: [ 'files' ]
auth__nsswitch_hosts_default: [ 'files', 'mdns4_minimal', '[NOTFOUND=return]', 'dns' ]
auth__nsswitch_networks_default: [ 'files' ]
auth__nsswitch_protocols_default: [ 'db', 'files' ]
auth__nsswitch_services_default: [ 'db', 'files' ]
auth__nsswitch_ethers_default: [ 'db', 'files' ]
auth__nsswitch_rpc_default: [ 'db', 'files' ]
auth__nsswitch_netgroup_default: [ 'nis' ]

auth__nscd_packages_default:
- nscd

auth__nslcd_packages_default:
- libnss-ldapd
- libpam-ldapd
- nslcd
- nslcd-utils
- ldap-utils

auth__nscd_packages_combined: "{{ auth__nscd_packages_default }}"
auth__nslcd_packages_combined: "{{ auth__nslcd_packages_default }}"
