---

# Do not change below this line

mosquitto__enable: "{{ mosquitto_enable | default(false) }}"
mosquitto__packages: "{{ mosquitto_packages | default(mosquitto__packages_default) }}"

mosquitto__conf_location: "{{ mosquitto_conf_location | default('/etc/mosquitto') }}"
mosquitto__security_location: "{{ mosquitto_security_location | default(mosquitto__conf_location + '/security') }}"

mosquitto__acl: "{{ mosquitto__acl_default | combine(mosquitto_acl, recursive=True) }}"

# =================================================================
# General configuration
# =================================================================

mosquitto__per_listener_settings: "{{ mosquitto_per_listener_settings | default(false) }}"
mosquitto__allow_zero_length_clientid: "{{ mosquitto_allow_zero_length_clientid | default(true) }}"
mosquitto__auto_id_prefix: "{{ mosquitto_auto_id_prefix | default('auto-') }}"
mosquitto__check_retain_source: "{{ mosquitto_check_retain_source | default(true) }}"
mosquitto__max_inflight_bytes: "{{ mosquitto_max_inflight_bytes | default(0) }}"
mosquitto__max_inflight_messages: "{{ mosquitto_max_inflight_messages | default(20) }}"
mosquitto__max_keepalive: "{{ mosquitto_max_keepalive | default(65535) }}"
mosquitto__max_packet_size: "{{ mosquitto_max_packet_size | default(0) }}"
mosquitto__max_queued_bytes: "{{ mosquitto_max_queued_bytes | default(0) }}"
mosquitto__max_qos: "{{ mosquitto_max_qos | default(2) }}"
mosquitto__max_queued_messages: "{{ mosquitto_max_queued_messages | default(1000) }}"
mosquitto__memory_limit: "{{ mosquitto_max_qos | default(0) }}"
mosquitto__message_size_limit: "{{ mosquitto_message_size_limit | default(0) }}"
mosquitto__persistent_client_expiration: "{{ mosquitto_persistent_client_expiration | default('') }}"
mosquitto__pid_file: "{{ mosquitto_pid_file | default('/var/run/mosquitto/mosquitto.pid') }}"
mosquitto__queue_qos0_messages: "{{ mosquitto_queue_qos0_messages | default(false) }}"
mosquitto__retain_available: "{{ mosquitto_retain_available | default(true) }}"
mosquitto__set_tcp_nodelay: "{{ mosquitto_set_tcp_nodelay | default(false) }}"
mosquitto__sys_interval: "{{ mosquitto_sys_interval | default(10) }}"
mosquitto__upgrade_outgoing_qos: "{{ mosquitto_upgrade_outgoing_qos | default(false) }}"
mosquitto__user: "{{ mosquitto_user | default('mosquitto') }}"

# =================================================================
# Listeners
# =================================================================
mosquitto__listeners: "{{ mosquitto_listeners | default([]) }}"

# =================================================================
# Persistence
# =================================================================

mosquitto__autosave_interval: "{{ mosquitto_autosave_interval | default(1800) }}"
mosquitto__autosave_on_changes: "{{ mosquitto_autosave_on_changes | default(false) }}"
mosquitto__persistence: "{{ mosquitto_persistence | default(false) }}"
mosquitto__persistence_file: "{{ mosquitto_persistence_file | default('mosquitto.db') }}"
mosquitto__persistence_location: "{{ mosquitto_persistence_location | default('/var/lib/mosquitto') }}"

# =================================================================
# Logging
# =================================================================

mosquitto__log_dest: "{{ mosquitto_log_dest | default('stderr') }}"
mosquitto__log_type: "{{ mosquitto_log_type | default(['error', 'warning']) }}"
mosquitto__connection_messages: "{{ mosquitto_connection_messages | default(true) }}"
mosquitto__log_facility: "{{ mosquitto_log_facility | default('') }}"
mosquitto__log_timestamp: "{{ mosquitto_log_timestamp | default(true) }}"
mosquitto__log_timestamp_format: "{{ mosquitto_log_timestamp | default('') }}"
mosquitto__websockets_log_level: "{{ mosquitto_websockets_log_level | default(0) }}"

# =================================================================
# Security
# =================================================================

mosquitto__clientid_prefixes: "{{ mosquitto_clientid_prefixes | default('') }}"
mosquitto__allow_anonymous: "{{ mosquitto_allow_anonymous | default(false) }}"

# -----------------------------------------------------------------
# Default authentication and topic access control
# -----------------------------------------------------------------

mosquitto__password_file: "{{ mosquitto_password_file | default('') }}"
mosquitto__psk_file: "{{ mosquitto_psk_file | default('') }}"
mosquitto__acl_file: "{{ mosquitto_acl_file | default('') }}"

# =================================================================
# Bridges
# =================================================================

mosquitto__bridges: "{{ mosquitto_bridges | default([]) }}"

# =================================================================
# External config files
# =================================================================

mosquitto__include_dir: "{{ mosquitto_include_dir | default(mosquitto__conf_location + '/conf.d') }}"

mosquitto__packages_default:
  - mosquitto
  - mosquitto-clients

mosquitto__acl_default:
  topic:
    - topic: $SYS/#
      access: read
      comment: This affects access control for clients with no username.
  pattern:
    - topic: $SYS/broker/connection/%c/state
      access: write
      comment: This affects all clients.
  user: {}
