---
# defaults file for roles/apt

#
# Substitutions
#

apt__flavor: "{{ apt_flavor | default(ansible_facts['lsb']['id']) | lower }}"

apt__conf_languages: "{{ apt_conf_languages | default(['en']) }}"
apt__conf_install_recommends: "{{ apt_conf_install_recommends | default(false) }}"
apt__conf_install_suggests: "{{ apt_conf_install_suggests | default(false) }}"

apt__conf_periodic_enable: "{{ apt_conf_periodic_enable | default(true) }}"
apt__conf_periodic_unattended_upgrade: "{{ apt_conf_periodic_unattended_upgrade | default(true) }}"
apt__conf_periodic_update_package_lists: "{{ apt_conf_periodic_update_package_lists | default(true) }}"
apt__conf_periodic_download_upgradeable_packages: "{{ apt_conf_periodic_download_upgradeable_packages | default(true) }}"
apt__conf_periodic_autoclean_interval: "{{ apt_conf_periodic_autoclean_interval | default(7) }}"
apt__conf_periodic_verbose:  "{{ apt_conf_periodic_verbose | default(0) }}"

apt__unattended_upgrades_auto_fix_interrupted_dpkg: "{{ apt_unattended_upgrades_auto_fix_interrupted_dpkg | default(true) }}"
apt__unattended_upgrades_minimal_steps: "{{ apt_unattended_upgrades_minimal_steps | default(true) }}"
apt__unattended_upgrades_ignore_apps_require_restart: "{{ apt_unattended_upgrades_ignore_apps_require_restart | default(true) }}"
apt__unattended_upgrades_install_on_shutdown: "{{ apt_unattended_upgrades_install_on_shutdown | default(false) }}"
apt__unattended_upgrades_mail: "{{ apt_unattended_upgrades_mail | default('') }}"
apt__unattended_upgrades_mail_report: "{{ apt_unattended_upgrades_mail_report | default('only-on-error') }}"
apt__unattended_upgrades_remove_unused_kernel_packages: "{{ apt_unattended_upgrades_remove_unused_kernel_packages | default(true) }}"
apt__unattended_upgrades_remove_new_unused_dependencies: "{{ apt_unattended_upgrades_remove_new_unused_dependencies | default(true) }}"
apt__unattended_upgrades_remove_unused_dependencies: "{{ apt_unattended_upgrades_remove_unused_dependencies | default(false) }}"
apt__unattended_upgrades_automatic_reboot: "{{ apt_unattended_upgrades_automatic_reboot | default(false) }}"
apt__unattended_upgrades_automatic_reboot_with_users: "{{ apt_unattended_upgrades_automatic_reboot_with_users | default(false) }}"
apt__unattended_upgrades_syslog_enable: "{{ apt_unattended_upgrades_syslog_enable | default(false) }}"
apt__unattended_upgrades_syslog_facility: "{{ apt_unattended_upgrades_syslog_facility | default('daemon') }}"
apt__unattended_upgrades_only_on_ac_power: "{{ apt_unattended_upgrades_only_on_ac_power | default(true) }}"
apt__unattended_upgrades_skip_updates_on_metered_connections: "{{ apt_unattended_upgrades_skip_updates_on_metered_connections | default(true) }}"
apt__unattended_upgrades_verbose: "{{ apt_unattended_upgrades_verbose | default(false) }}"
apt__unattended_upgrades_debug: "{{ apt_unattended_upgrades_debug | default(false) }}"
apt__unattended_upgrades_allow_downgrade: "{{ apt_unattended_upgrades_allow_downgrade | default(false) }}"
apt__unattended_upgrades_allow_apt_mark_fallback: "{{ apt_unattended_upgrades_allow_apt_mark_fallback | default(true) }}"
apt__unattended_upgrades_origin_pattern: "{{ apt_unattended_upgrades_origin_pattern | default(apt__unattended_upgrades_origin_pattern_default[apt__flavor]) }}"

#
# Do not change from here
#

apt__packages_default:
- apt-transport-https
- curl
- gpg
- python3-apt

apt__packages_ensure: "{{ apt__packages_default }}"
apt__packages: "{{ apt_packages | default([]) + apt__packages_ensure }}"

apt__unattended_upgrades_origin_pattern_default:
  debian:
    - origin: Debian
      codename: ${distro_codename}
      label: Debian
    - origin: Debian
      codename: ${distro_codename}-proposed-updates
      label: Debian
    - origin: Debian
      codename: ${distro_codename}-updates
      label: Debian
    - origin: Debian
      codename: ${distro_codename}
      label: Debian-Security
    - origin: Debian
      codename: ${distro_codename}-security
      label: Debian-Security
    - origin: Debian Backports
      codename: ${distro_codename}-backports
      label: Debian
  ubuntu:
    - origin: Ubuntu
      codename: ${distro_codename}
      label: Ubuntu
    - origin: Ubuntu
      codename: ${distro_codename}-backports
      label: Ubuntu
    - origin: Ubuntu
      codename: ${distro_codename}-updates
      label: Ubuntu-Security
    - origin: Ubuntu
      codename: ${distro_codename}-security
      label: Ubuntu-Security

apt__files_absent: "{{
  apt_conf_d_files_absent | default([]) | map('regex_replace', '^(.*)$', '/etc/apt/apt.conf.d/\\1') +
  apt_sources_lists_d_files_absent | default([]) | map('regex_replace', '^(.*)$', '/etc/apt/sources.list.d/\\1') +
  [ '/etc/apt/sources.list', '/etc/apt/sources.list.d/raspi.list', '/etc/apt/sources.list.d/vscode.list' ]
}}"

apt__sources: "{{ apt_sources | default([]) }}"
