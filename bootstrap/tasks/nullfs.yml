---
# tasks file for roles/bootstrap

- name: Create nullfs source directories
  tags: [ bootstrap, mount, bind ]
  ansible.builtin.file:
    path: "{{ item.src }}"
    owner: "{{ item.owner }}"
    group: "{{ item.group }}"
    mode: "{{ item.mode }}"
    state: directory
  with_items: "{{ bootstrap__mount }}"

- name: Create nullfs mountpoints
  tags: [ bootstrap, mount, bind ]
  ansible.builtin.file:
    path: "{{ item.path }}"
    owner: "{{ item.owner }}"
    group: "{{ item.group }}"
    mode: "{{ item.mode }}"
    state: directory
  with_items: "{{ bootstrap__mount }}"

- name: Mount nullfs locations
  tags: [ bootstrap, mount, bind ]
  ansible.posix.mount:
    src: "{{ item.src }}"
    path: "{{ item.path }}"
    opts: "{{ item.options }}"
    state: mounted
    fstype: none
  with_items: "{{ bootstrap__mount }}"
